
<!DOCTYPE html>
<html lang="de">
<head>
<script>
    const correctPassword = "SSVK√∂fering1926";

    // Passwort nur abfragen, wenn nicht schon eingeloggt
    if (localStorage.getItem("auth") !== "ok") {
        let authenticated = false;

        while (!authenticated) {
            const userPassword = prompt("Bitte Passwort eingeben:");

            // Wenn der Benutzer auf ‚ÄûAbbrechen‚Äú klickt
            if (userPassword === null) {
                // Meldung anzeigen und Schleife beenden
                alert("Zugriff verweigert.");
                break;
            }

            if (userPassword === correctPassword) {
                localStorage.setItem("auth", "ok");
                authenticated = true;
            } else {
                alert("Passwort falsch. Bitte erneut versuchen.");
                // Schleife l√§uft weiter, neue Passworteingabe
            }
        }

        // Wenn nach der Schleife immer noch nicht eingeloggt ‚Üí Seite sperren
        if (!authenticated && localStorage.getItem("auth") !== "ok") {
            window.onload = () => {
                document.body.innerHTML = "<h2>Zugriff verweigert</h2>";
            };
        }
    }
</script>



<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watt-Turnier Anmeldung</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#3656A7">



<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        text-align: center;
        margin-bottom: 80px; /* Platz f√ºr die Men√ºleiste */
    }
    h1 {
        margin-bottom: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    table, th, td {
        border: 1px solid #000;
    }
    th, td {
        padding: 8px;
        text-align: center;
    }
    th {
        background-color: #3656A7;
        color: white;
    }
    td {
        background-color: #ADD8E6;
    }
    button {
        margin: 5px;
        padding: 10px;
        background-color: #3656A7;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
        border-radius: 4px;
    }
    button:hover {
        background-color: #2a4485;
    }
    .form-container {
        border: 2px solid #3656A7;
        padding: 15px;
        margin: 20px auto;
        width: 90%;
        max-width: 400px;
        border-radius: 8px;
        background-color: #f9f9f9;
        text-align: center;
    }
    .form-container h3 {
        color: #3656A7;
        margin-bottom: 10px;
    }
    .form-container input[type="text"] {
        width: 80%;
        padding: 8px;
        margin-bottom: 10px;
        font-size: 16px;
    }
    /* ‚úÖ Men√ºleiste */
    .app-menu {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: #3656A7;
        display: flex;
        justify-content: space-around;
        padding: 10px 0;
        border-top: 2px solid #2a4485;
        z-index: 1000;
    }
    .app-menu a {
        color: white;
        text-decoration: none;
        font-size: 14px;
        text-align: center;
        flex: 1;
    }
    .app-menu a:hover {
        background-color: #2a4485;
        padding: 8px;
        border-radius: 4px;
    }
    @media (max-width: 600px) {
        .form-container {
            width: 95%;
        }
        table {
            font-size: 14px;
        }
    }
.turnier-details {
    display: grid;
    grid-template-columns: 120px auto;
    row-gap: 8px;
    justify-content: center;
    margin: 0 auto 20px auto;
    text-align: left;
    max-width: 400px;
}

.turnier-details .label {
    font-weight: bold;
}

.turnier-details .value input {
    width: 100%;
}
    
</style>
</head>
<body>
<button class="logout-btn" onclick="logout()">Logout</button>

<script>
function logout() {
    localStorage.removeItem("auth");
    location.reload();
}
</script>

<style>
.logout-btn {
    position: fixed;
    top: 10px;
    right: 10px;
    background-color: #3656A7;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
    z-index: 2000;
}

.logout-btn:hover {
    background-color: #2a4485;
}
</style>

    
<h1>Anmeldung f√ºr das Watt-Turnier</h1>

<section>
    <h2>Turnierdetails</h2>
    <div class="turnier-details">
    <div class="label">Datum:</div>
    <div class="value"><input id="tournament-date" onchange="saveTournamentDetails()" /></div>

    <div class="label">Ort:</div>
    <div class="value"><input id="tournament-location" onchange="saveTournamentDetails()" /></div>

    <div class="label">Startgeld:</div>
    <div class="value"><input id="tournament-fee" onchange="saveTournamentDetails()" /></div>
</div>

</section>

<!-- Komfortables Eingabeformular -->
<div class="form-container">
    <h3>Neues Team hinzuf√ºgen</h3>
    <input type="text" id="player1" placeholder="Spieler 1">
    <input type="text" id="player2" placeholder="Spieler 2">
    <button onclick="addTeamFromForm()">‚ûï Team hinzuf√ºgen</button>
</div>

<button onclick="deleteAllTeams()" style="background-color:#B22222;">‚ö† Alle Teams &amp; Turnierdaten l√∂schen</button>

<table id="team-table">
    <thead>
        <tr><th>#</th><th>Spieler 1</th><th>Spieler 2</th><th>Bezahlt</th><th>Aktionen</th></tr>
    </thead>
    <tbody></tbody>
</table>

<!-- ‚úÖ Men√ºleiste -->
<nav class="app-menu">
    <a href="index.html">üè†<br>Anmeldung</a>
    <a href="vorrunde.html">üìã<br>Vorrunde</a>
    <a href="auslosung1.html">üé≤<br>Auslosung 1</a>
    <a href="auslosung2.html">üé≤<br>Auslosung 2</a>
    <a href="auslosung3.html">üé≤<br>Auslosung 3</a>
    <a href="auslosung4.html">üé≤<br>Auslosung 4</a>
    <a href="auslosung5.html">üé≤<br>Auslosung 5</a>
    <a href="viertelfinale.html">üèÜ<br>Viertelfinale</a>
    <a href="halbfinale.html">ü•à<br>Halbfinale</a>
    <a href="finale.html">ü•á<br>Finale</a>
</nav>

<script>
function saveTournamentDetails() {
    const details = {
        date: document.getElementById('tournament-date').value,
        location: document.getElementById('tournament-location').value,
        fee: document.getElementById('tournament-fee').value
    };
    localStorage.setItem('wattTournamentDetails', JSON.stringify(details));
}

function loadTournamentDetails() {
    const saved = JSON.parse(localStorage.getItem('wattTournamentDetails'));
    if (saved) {
        document.getElementById('tournament-date').value = saved.date;
        document.getElementById('tournament-location').value = saved.location;
        document.getElementById('tournament-fee').value = saved.fee;
    } else {
        document.getElementById('tournament-date').value = "14. Juni 2025";
        document.getElementById('tournament-location').value = "Albert-Kaindl-Sportheim";
        document.getElementById('tournament-fee').value = "10‚Ç¨ pro Teilnehmer";
    }
}

function addTeamFromForm() {
    const player1 = document.getElementById('player1').value.trim();
    const player2 = document.getElementById('player2').value.trim();
    if (!player1 || !player2) {
        alert("Bitte beide Spielernamen eingeben!");
        return;
    }
    const table = document.querySelector('#team-table tbody');
    const row = table.insertRow();
    row.insertCell(0).textContent = table.rows.length + 1;
    row.insertCell(1).innerHTML = `<input type="text" value="${player1}" oninput="updateLocalStorage()">`;
    row.insertCell(2).innerHTML = `<input type="text" value="${player2}" oninput="updateLocalStorage()">`;
    row.insertCell(3).innerHTML = `<input type="checkbox" onchange="updateLocalStorage()">`;
    row.insertCell(4).innerHTML = `<button onclick="deleteTeam(this)">L√∂schen</button>`;
    document.getElementById('player1').value = '';
    document.getElementById('player2').value = '';
    document.getElementById('player1').focus();
    updateLocalStorage();
}

function deleteTeam(button) {
    button.closest('tr').remove();
    updateLocalStorage();
}

function deleteAllTeams() {
    if (confirm("M√∂chtest du wirklich alle Teams und Turnierdaten l√∂schen?")) {
        document.querySelector('#team-table tbody').innerHTML = '';
        localStorage.removeItem('wattTeams');
        localStorage.removeItem('quarterfinalPairs');
        localStorage.removeItem('semifinalTeams');
        localStorage.removeItem('semifinalPairs');
        localStorage.removeItem('finalTeams');
        localStorage.removeItem('thirdPlaceTeams');
        localStorage.removeItem('tournamentWinner');
        localStorage.removeItem('runnerUp');
        localStorage.removeItem('thirdPlaceWinner');
        localStorage.removeItem('fourthPlace');
        alert("Alle Teams und Turnierdaten wurden gel√∂scht!");
    }
}

function updateLocalStorage() {
    const rows = document.querySelectorAll('#team-table tbody tr');
    const teams = [];
    const existingTeams = JSON.parse(localStorage.getItem('wattTeams')) || [];

    rows.forEach((row, i) => {
        const player1 = row.cells[1].querySelector('input').value;
        const player2 = row.cells[2].querySelector('input').value;
        const paid = row.cells[3].querySelector('input').checked;

        const existingTeam = existingTeams.find(t => t.player1 === player1 && t.player2 === player2);
        const rounds = existingTeam ? existingTeam.rounds : Array(5).fill({ points: 0, goals: 0 });

        if (player1 && player2) teams.push({ player1, player2, paid, rounds });
        row.cells[0].textContent = i + 1;
    });

    localStorage.setItem('wattTeams', JSON.stringify(teams));
}

function loadTeams() {
    const teams = JSON.parse(localStorage.getItem('wattTeams')) || [];
    const table = document.querySelector('#team-table tbody');
    teams.forEach((team, i) => {
        const row = table.insertRow();
        row.insertCell(0).textContent = i + 1;
        row.insertCell(1).innerHTML = `<input type="text" value="${team.player1}" oninput="updateLocalStorage()">`;
        row.insertCell(2).innerHTML = `<input type="text" value="${team.player2}" oninput="updateLocalStorage()">`;
        row.insertCell(3).innerHTML = `<input type="checkbox" ${team.paid ? 'checked' : ''} onchange="updateLocalStorage()">`;
        row.insertCell(4).innerHTML = `<button onclick="deleteTeam(this)">L√∂schen</button>`;
    });
}

document.addEventListener('DOMContentLoaded', () => {
    loadTournamentDetails();
    loadTeams();
    document.getElementById('player1').focus();

    document.getElementById('player2').addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            addTeamFromForm();
        }
    });
});
</script>

<!-- Service Worker Registrierung -->

<script>
navigator.serviceWorker.register("/watt-turnier-app/service-worker.js")
.then(reg => {

    // Wenn ein neuer Service Worker installiert wird ‚Üí sofort aktivieren
    reg.addEventListener("updatefound", () => {
        const newSW = reg.installing;
        newSW.addEventListener("statechange", () => {
            if (newSW.state === "installed") {
                newSW.postMessage({ type: "SKIP_WAITING" });
            }
        });
    });

    // Falls bereits ein SW wartet ‚Üí sofort aktivieren
    if (reg.waiting) {
        reg.waiting.postMessage({ type: "SKIP_WAITING" });
    }
});
</script>
<script>
navigator.serviceWorker.addEventListener("controllerchange", () => {
    window.location.reload();
});
</script>

   
<!-- Versionsanzeige -->
<!-- Versionsanzeige -->
<div id="app-version" 
     style="position:fixed; bottom:110px; right:10px; background:#eee; padding:5px 10px; border-radius:5px; font-size:12px; color:#333; z-index:999999;">
    Version l√§dt‚Ä¶
</div>
<script>
// Version vom Service Worker anfordern
if (navigator.serviceWorker && navigator.serviceWorker.controller) {
    navigator.serviceWorker.controller.postMessage({ type: "GET_VERSION" });
} else {
    // Falls der SW noch nicht aktiv ist, sp√§ter erneut versuchen
    navigator.serviceWorker.addEventListener("controllerchange", () => {
        navigator.serviceWorker.controller.postMessage({ type: "GET_VERSION" });
    });
}

// Antwort vom Service Worker empfangen
navigator.serviceWorker.addEventListener("message", event => {
    if (event.data && event.data.type === "VERSION") {
        const versionBox = document.getElementById("app-version");
        versionBox.textContent = "Version " + event.data.version;
    }
});
</script>


    
    <div id="update-banner" 
     style="
       display:none;
       position:fixed;
       bottom:70px;
       left:0;
       right:0;
       background:#3656A7;
       color:white;
       padding:15px;
       text-align:center;
       font-size:16px;
       z-index:999999;
     ">
  Neue Version verf√ºgbar ‚Äì tippe hier zum Aktualisieren
</div>

<script>
// Automatische Versionsanzeige
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.addEventListener("controllerchange", () => {
    const banner = document.getElementById("update-banner");
    if (banner) {
      banner.style.display = "block";
    }
  });
}

// Klick auf Banner ‚Üí Seite neu laden
document.getElementById("update-banner").addEventListener("click", () => {
  location.reload();
});
</script>

</body>
</html>






















